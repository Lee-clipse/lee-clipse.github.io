---
layout: single
title: "NCP 사용 후기 with 청건부산 프로젝트"
date: 2023-11-15
excerpt: ""
tags: [posts, log]
categories: [posts/log]
classes: wide
---

<figure style="width: 70%" class="align-center">
    <img src="/assets/img/posts/2023-11-15-썸네일.png">
</figure>

네이버클라우드의 예비/주니어 개발자 지원 프로그램 `Green Developers`에 참가하며 쓴 글입니다.

## 왜 NCP?

22년도에 진행한 네이버 부스트캠프 웹모바일 7기에서 인생 첫 배포를 할 기회가 생겼다.

Cloud 분야를 처음 접하는데에다가, 부스트캠프 측에서 크레딧도 20만원이나 지원해 주었다.

이를 계기로 사이드 프로젝트에 지속적으로 사용하고 있다.

## 어떤 프로젝트?

올해로 15년째인 Together Festival 이라는 부산의 지역 축제에서 웹 사이트 개발을 담당하게 되었다.

행사 당일(2023년 9월 23일) 접속자 수가 1,000 ~ 2,000명을 예상해서 이에 맞추어 개발에 착수했다.

전반적으로 설명하자면 Node.js 환경에서 안내 웹 사이트를 구축했다고 할 수 있다.

축제 컨텐츠, 타임 테이블, 체험 부스 등을 안내하는 목적으로 웹 서버를 개발했다.

축제 내 게임 참가에 필요한 접수 및 팀 편성을 위해 MySQL Cloud DB를 사용, API 서버를 개발했다.

게임 알고리즘을 실행시키고 실시간 데이터를 처리하기 위해 Redis Cloud DB를 사용, API 서버를 개발했다.

- [프로젝트 Github ](https://github.com/Lee-clipse/tf-15th-website)

- [청건부산 웹 사이트 (모바일 전용)](https://busan-tf.n-e.kr/)

## 어떻게 NCP 사용?

<figure style="width: 70%" class="align-center">
    <img src="/assets/img/posts/2023-11-15-인프라.png">
</figure>

정적 컨텐츠 serving, API 서버를 목적으로 VPC Server를 개설했다.

React를 통해 개발한 build 폴더를 Nginx로 serving 하는 방식으로,

공인 IP를 할당 받아서 웹 서버를 구축했다.

참가자의 데이터를 저장하고 다루기 위해 API 서버와 DB도 필요했다.

API 서버용 포트를 하나 더 열고, Cloud DB for MySQL 서비스를 통해 DB Storage를 생성했다.

또한 제로게임이라는 실시간 팀 부루마블 형식의 게임을 운영하기 위해 포트를 하나 더 열고,

Cloud DB for Redis 서비스를 통해 DB Storage를 생성했다.

Cloud DB와 서버간의 연결을 위해 ACG 또한 설정했다.

마지막으로, 행사 당일 날 접속 트래픽과 로그를 확인하기 위해 Web service Monitoring System을 신청했다.

> 이거 있나? 싶어서 찾아본 서비스가 모두 지원 중이라 놀라웠다...

## 좋았던 점

DevOps를 처음 접하는 한국인들에게 한국어 메뉴얼과 UI는 정말 큰 장점이라고 느꼈다.

덕분에 낯선 키워드에 대한 개념을 익히고, 이를 실제로 사용해서 인프라를 구축하는 등 좋은 영양분이 되었다.

그 외에도 프로젝트를 진행하며 겪었던 크고 작은 이슈에서 NCP의 도움을 받았던 경우를 소개하고자 한다.

### 서버 스펙 변경

사용자 규모를 미리 예측하고 서비스를 개발하는 건 처음이었다.

심지어 100, 200명도 아니고 단기간에 1,000명이 넘는 사용자가 접속하는 상황에서,

서버의 스펙을 쉽사리 결정하기 어려웠다.

<figure style="width: 75%" class="align-center">
    <img src="/assets/img/posts/2023-11-15-서버-증설.png">
</figure>

나중에 알게 된 것인데, 서버를 정지 후 스펙을 바꿀 수 있음을 발견했다.

덕분에 API 부하 테스트를 진행 후 CPU를 증설할 수 있었다.

### 의문의 해킹 시도

청건부산 홍보 팀이 행사를 여러 군데에 다양한 방법으로 홍보했다.

블로그, 인스타, 부산대학교 내 포스터, 지하철 광고 등 다양했다.

한창 개발 중인 어느 날 아래와 같은 메일을 받았다.

<figure style="width: 55%" class="align-center">
    <img src="/assets/img/posts/2023-11-15-메일.png">
</figure>

해킹 시도를 당해보는 것은 처음이었고, 이 외에도 수차례 IP를 바꿔가며 다양한 공격 시도를 당했다.

이 메일 덕분에 ACG에 IP 설정을 하여 피해를 막을 수 있었다.

어디서 어떻게 접근했는 지는 모르나, 내 코드보다 NCP의 방화벽과 보안을 믿는 믿음으로 개발했다.

### 모니터링 시스템

9월 23일 무사히 행사를 마친 후, 사후 보고 데이터를 수집하던 중 깜빡한 게 있었다.

행사 당일 동시 접속자 수를 체크하지 않은 것이었다.

우리 서비스에 다녀간 사람들의 수를 알지 못하게 되는 건가 싶어서 방법을 찾아보다,

이전에 신청했던 Web service Monitoring System이 떠올랐다.

덕분에 서버에 남은 로그 파일에 Linux 명령어를 조합하여 중복 없는 동시 접속자 수를 산출해낼 수 있었다.

뿐만 아니라 행사 도중 계속 모니터 로그를 들여다보지 않더라도,

1분마다 가용성을 체크해주는 서비스의 도움을 받아 편할 수 있었다.

## 아쉬웠던 점

솔직히 여타 Cloud 서비스들을 빈번히 이용해보지 않아서 기술적인 비교가 어려운 것 같다.

하지만 들리는 바 NCP의 사용 금액이 비싼 편이라 꺼리는 사람도 있다고 하는데,

워낙 NCP에서 크레딧 지원을 자주 한다고 느껴져서 아쉽다고 다가오지 않았다.

### 예제 인프라

React든 NestJS든 공식 사이트에 예제 코드가 있기 마련이다.

Cloud 분야 자체를 아예 처음 접하던 예전에는, 웹 인프라를 대체 어떻게 구축해야 하는 지 감도 못잡았었다.

개인의 노력과 학습으로 알아내야 한다고 하면 맞는 말이지만,

초보 개발자들을 지원하는 취지로, 정말 간단한 Todo-List 서비스를 예시로 삼아,

API 서버, DB까지라도 좋으니 예시로 구축하고 연동하는 영상이나 메뉴얼이 있었으면 어떨까 한다.

## 마무리

네이버 부스트캠프 시절, NCP를 사용하는 방법을 아예 몰라 구글에 NCP를 검색하던 때가 기억난다.

AWS와 다르게 사용 설명 블로그가 현저히 적어서 충격받았던 것도 떠오른다.

나같은 초보 개발자가 생판 처음 인프라를 구축할때 도움이 되었으면 하는 마음에,

아래 두 글을 이전에 작성해서 블로그에 올렸던 적이 있다.

- [NCP 서버와 DB 따로 배포 후 연동](https://halls99.tistory.com/entry/nCloud-%EC%84%9C%EB%B2%84%EC%99%80-DB-%EB%94%B0%EB%A1%9C-%EB%B0%B0%ED%8F%AC-%ED%9B%84-%EC%97%B0%EB%8F%99)

- [NCP에서 Docker 적용하기](https://halls99.tistory.com/entry/Docker-nCloud-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1)

마침 `Green Developers`라는 좋은 취지의 프로그램이 있길래 이 글을 끄적인다.
